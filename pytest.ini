[pytest]
# Configuration pytest pour AIME

# Répertoire racine pour la découverte des tests
testpaths = tests

# Pattern de fichiers de test
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Options
addopts = 
    # Verbose output
    -v
    # Afficher les print() et logs
    -s
    # Coverage
    --cov=app
    --cov-report=html:test-reports/coverage
    --cov-report=term-missing:skip-covered
    --cov-report=xml:test-reports/coverage.xml
    # Rapports JUnit
    --junit-xml=test-reports/junit.xml
    # Markers personnalisés
    -m "not slow"

# Markers
markers =
    unit: Tests unitaires
    integration: Tests d'intégration
    e2e: Tests end-to-end
    async: Tests asynchrones
    slow: Tests lents (skip par défaut)
    external: Tests qui font des appels externes
    db: Tests qui utilisent la base de données

# Asyncio mode
asyncio_mode = auto

# Ignore les warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Plugins
# plugins = pytest-asyncio pytest-timeout pytest-cov

# Logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s - %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

log_file = test-reports/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] %(filename)s:%(lineno)d - %(funcName)s() - %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# Timeout par défaut
# timeout = 300
# timeout_method = thread
