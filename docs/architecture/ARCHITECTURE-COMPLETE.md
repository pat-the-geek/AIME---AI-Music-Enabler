# ğŸ—ï¸ Architecture AIME - AI Music Enabler v4.4.0

## Vue d'Ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AIME - AI Music Enabler                              â”‚
â”‚                    Application Web de Tracking Musical                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND (React)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  React 18 + TypeScript + Material-UI + Vite                                 â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Collection â”‚  â”‚  Journal   â”‚  â”‚  Timeline  â”‚  â”‚ FloatingRoonWidget â”‚â—„â”€â”€â”¤
â”‚  â”‚  (Albums)  â”‚  â”‚ (History)  â”‚  â”‚  (Hourly)  â”‚  â”‚   (Now Playing)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Playlists  â”‚  â”‚  Settings  â”‚  â”‚ Analytics  â”‚  â”‚   Roon Controls    â”‚â—„â”€â”€â”¤
â”‚  â”‚  + Roon    â”‚  â”‚ (Trackers) â”‚  â”‚   (Stats)  â”‚  â”‚ (Play/Pause/Next)  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW v4.4
â”‚  â”‚   ğŸ“– Magazine      â”‚                                                      â”‚
â”‚  â”‚  (5 Pages Ã‰dit.)   â”‚  5 pages scrollables:                              â”‚
â”‚  â”‚ - Artiste AlÃ©at.   â”‚  â”œâ”€ Page 1: Artiste + albums + haÃ¯ku               â”‚
â”‚  â”‚ - Album Spotlight  â”‚  â”œâ”€ Page 2: Album + desc. IA longue (2000+)       â”‚
â”‚  â”‚ - HaÃ¯kus EurIA     â”‚  â”œâ”€ Page 3: 3 haÃ¯kus alÃ©atoires                    â”‚
â”‚  â”‚ - Timeline         â”‚  â”œâ”€ Page 4: Timeline + stats rÃ©centes               â”‚
â”‚  â”‚ - Playlist ThÃ¨me   â”‚  â””â”€ Page 5: Playlist thÃ¨me + desc. crÃ©ative        â”‚
â”‚  â”‚                    â”‚                                                     â”‚
â”‚  â”‚ â€¢ Glassmorphism    â”‚  Design moderne + navigation fluide                â”‚
â”‚  â”‚ â€¢ Auto-refresh 15m â”‚  Nouvelle Ã©dition + minuteur visible               â”‚
â”‚  â”‚ â€¢ Layouts alÃ©at.   â”‚  Responsive (Desktop/Tablet/Mobile)                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚                                                                              â”‚
â”‚                                                                              â”‚
â”‚  API Client (Axios) - Communication REST avec Backend                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTP/REST (Port 5173 â†’ 8000)
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           BACKEND (FastAPI)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Python 3.10-3.14 + FastAPI + SQLAlchemy + APScheduler                      â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ API v1 Routes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                                                                â”‚           â”‚
â”‚  â”‚  /collection  /history  /playlists  /services  /roon â—„â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ NEW  â”‚
â”‚  â”‚  /analytics   /search   /magazines â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ v4.4  â”‚
â”‚  â”‚                                                                â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Services Layer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                                                                â”‚           â”‚
â”‚  â”‚  TrackerService       : Polling Last.fm (120s) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ Auto    â”‚
â”‚  â”‚  RoonTrackerService   : Polling Roon zones (120s) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ Restart â”‚
â”‚  â”‚  SchedulerService     : TÃ¢ches planifiÃ©es (cron) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ Enabled â”‚
â”‚  â”‚                                                                â”‚           â”‚
â”‚  â”‚  RoonService â—„â”€â”€â”€â”€â”€â”€â”€â”€: ContrÃ´le direct Roon (pyroon) â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ NEW  â”‚
â”‚  â”‚  SpotifyService       : Enrichissement mÃ©tadonnÃ©es            â”‚           â”‚
â”‚  â”‚  DiscogsService       : Import collection vinyles             â”‚           â”‚
â”‚  â”‚  LastFMService        : API Last.fm                           â”‚           â”‚
â”‚  â”‚  AIService (EurIA)    : GÃ©nÃ©ration descriptions IA            â”‚           â”‚
â”‚  â”‚  MagazineGeneratorService : GÃ©nÃ©ration magazine Ã©ditorial â—„â”€â”€â”€â”€â”¼â”€ v4.4   â”‚
â”‚  â”‚  MarkdownExportService: Export formatÃ©                        â”‚           â”‚
â”‚  â”‚                                                                â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Models (SQLAlchemy) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                                                                â”‚           â”‚
â”‚  â”‚  Album            Artist          Track                       â”‚           â”‚
â”‚  â”‚  ListeningHistory AlbumArtist     Image                       â”‚           â”‚
â”‚  â”‚  Metadata         Playlist        PlaylistTrack               â”‚           â”‚
â”‚  â”‚  ServiceState â—„â”€â”€â”€: Persistance Ã©tats (auto-restart) â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ NEW  â”‚
â”‚  â”‚                                                                â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          BASE DE DONNÃ‰ES (SQLite)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Tables:                                                                     â”‚
â”‚  â”œâ”€ albums               : Collection complÃ¨te (Discogs, Roon, manuels)     â”‚
â”‚  â”œâ”€ artists              : Artistes avec images                             â”‚
â”‚  â”œâ”€ album_artist         : Table association many-to-many                   â”‚
â”‚  â”œâ”€ tracks               : Morceaux individuels                             â”‚
â”‚  â”œâ”€ listening_history    : Journal d'Ã©coute (Last.fm, Roon)                â”‚
â”‚  â”œâ”€ images               : Images albums/artistes (Spotify, Last.fm, Discog)â”‚
â”‚  â”œâ”€ metadata             : MÃ©tadonnÃ©es enrichies (descriptions IA)          â”‚
â”‚  â”œâ”€ playlists            : Playlists gÃ©nÃ©rÃ©es (7 algorithmes)               â”‚
â”‚  â”œâ”€ playlist_tracks      : Tracks associÃ©s aux playlists                    â”‚
â”‚  â”œâ”€ magazines â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€: Magazines gÃ©nÃ©rÃ©s (archives) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ v4.4   â”‚
â”‚  â””â”€ service_states â—„â”€â”€â”€â”€â”€: Ã‰tats trackers/scheduler (auto-restart) â”€ NEW   â”‚
â”‚                                                                              â”‚
â”‚  Indexes:                                                                    â”‚
â”‚  â”œâ”€ idx_albums_source                                                        â”‚
â”‚  â”œâ”€ idx_listening_history_listened_at                                       â”‚
â”‚  â”œâ”€ idx_service_states_last_updated â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW   â”‚
â”‚  â””â”€ ... (autres indexes pour performance)                                   â”‚
â”‚                                                                              â”‚
â”‚  Fichier: backend/data/musique.db                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SERVICES EXTERNES (APIs)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Last.fm    â”‚  â”‚   Spotify    â”‚  â”‚   Discogs    â”‚  â”‚  Roon Server â”‚â—„â”€â”€â”¤
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚   (pyroon)   â”‚   â”‚
â”‚  â”‚  - Scrobbles â”‚  â”‚  - Images    â”‚  â”‚  - Collectionâ”‚  â”‚  - Zones     â”‚   â”‚
â”‚  â”‚  - Metadata  â”‚  â”‚  - URLs      â”‚  â”‚  - Vinyl     â”‚  â”‚  - Now Play  â”‚   â”‚
â”‚  â”‚  - Multi-src â”‚  â”‚  - Details   â”‚  â”‚  - Details   â”‚  â”‚  - Control   â”‚   â”‚
â”‚  â”‚    (Roon ARC)â”‚  â”‚              â”‚  â”‚              â”‚  â”‚    Playback  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚ EurIA (IA)   â”‚  Infomaniak AI Service                                    â”‚
â”‚  â”‚              â”‚                                                            â”‚
â”‚  â”‚  - Desc. IA  â”‚  - GÃ©nÃ©ration descriptions albums                         â”‚
â”‚  â”‚  - Haikus    â”‚  - GÃ©nÃ©ration haikus                                      â”‚
â”‚  â”‚  - Summaries â”‚  - RÃ©sumÃ©s intelligents                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICES BACKGROUND (APScheduler)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ TrackerService (Last.fm)                                     â”‚           â”‚
â”‚  â”‚  â”œâ”€ Polling: toutes les 120s                                â”‚           â”‚
â”‚  â”‚  â”œâ”€ DÃ©tection nouveaux tracks                               â”‚           â”‚
â”‚  â”‚  â”œâ”€ Enrichissement auto (Spotify + IA)                      â”‚           â”‚
â”‚  â”‚  â””â”€ Auto-restart aprÃ¨s reboot serveur â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ RoonTrackerService                                           â”‚           â”‚
â”‚  â”‚  â”œâ”€ Polling: toutes les 120s                                â”‚           â”‚
â”‚  â”‚  â”œâ”€ DÃ©tection zones actives                                 â”‚           â”‚
â”‚  â”‚  â”œâ”€ Now playing tracking                                    â”‚           â”‚
â”‚  â”‚  â”œâ”€ Gestion zones multi-room                                â”‚           â”‚
â”‚  â”‚  â”œâ”€ Attente chargement zones (5s max) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€ FIX    â”‚
â”‚  â”‚  â””â”€ Auto-restart aprÃ¨s reboot serveur â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ SchedulerService (TÃ¢ches PlanifiÃ©es)                        â”‚           â”‚
â”‚  â”‚  â”œâ”€ 2h00: Enrichissement quotidien (50 albums)             â”‚           â”‚
â”‚  â”‚  â”œâ”€ 6h00: GÃ©nÃ©ration haikus (5 albums alÃ©atoires)          â”‚           â”‚
â”‚  â”‚  â”œâ”€ 8h00: Export collection Markdown                       â”‚           â”‚
â”‚  â”‚  â”œâ”€ 10h00: Export collection JSON                          â”‚           â”‚
â”‚  â”‚  â”œâ”€ Dimanche 20h: Haiku hebdomadaire                       â”‚           â”‚
â”‚  â”‚  â”œâ”€ 1er du mois 3h: Analyse mensuelle                      â”‚           â”‚
â”‚  â”‚  â”œâ”€ Toutes les 6h: Optimisation descriptions IA            â”‚           â”‚
â”‚  â”‚  â”œâ”€ Cleanup automatique (max 5 fichiers/type)              â”‚           â”‚
â”‚  â”‚  â””â”€ Auto-restart aprÃ¨s reboot serveur â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ MagazineGeneratorService (Nouveau v4.4)                     â”‚           â”‚
â”‚  â”‚  â”œâ”€ GÃ©nÃ©ration contenus alÃ©atoires                          â”‚           â”‚
â”‚  â”‚  â”œâ”€ 5 pages Ã©ditorialisÃ©es:                                â”‚           â”‚
â”‚  â”‚  â”‚  â”œâ”€ Page 1: Artiste alÃ©atoire + albums + haÃ¯ku          â”‚           â”‚
â”‚  â”‚  â”‚  â”œâ”€ Page 2: Album spotlight + desc. IA longue (2000+)   â”‚           â”‚
â”‚  â”‚  â”‚  â”œâ”€ Page 3: 3 haÃ¯kus EurIA alÃ©atoires                   â”‚           â”‚
â”‚  â”‚  â”‚  â”œâ”€ Page 4: Timeline Ã©coutes rÃ©centes + stats           â”‚           â”‚
â”‚  â”‚  â”‚  â””â”€ Page 5: Playlist thÃ¨me + desc. crÃ©ative             â”‚           â”‚
â”‚  â”‚  â”œâ”€ IntÃ©gration EurIA (IA native)                          â”‚           â”‚
â”‚  â”‚  â”‚  â”œâ”€ GÃ©nÃ©ration haÃ¯kus (5-7-5 syllabes)                  â”‚           â”‚
â”‚  â”‚  â”‚  â”œâ”€ Descriptions crÃ©atives (2000+ caractÃ¨res)           â”‚           â”‚
â”‚  â”‚  â”‚  â””â”€ Titres thÃ©matiques engageants                       â”‚           â”‚
â”‚  â”‚  â”œâ”€ Layouts variables (images/textes positionnÃ©s alÃ©at.)   â”‚           â”‚
â”‚  â”‚  â”œâ”€ Palettes couleurs alÃ©atoires (3 schÃ©mas)              â”‚           â”‚
â”‚  â”‚  â”œâ”€ Auto-refresh: nouvelle Ã©dition toutes les 15 minutes  â”‚           â”‚
â”‚  â”‚  â”œâ”€ Stockage: archives magazines dans table magazines     â”‚           â”‚
â”‚  â”‚  â”œâ”€ Frontend: route /magazine avec 5 pages scrollables    â”‚           â”‚
â”‚  â”‚  â””â”€ Endpoints: /api/v1/magazines/generate/regenerate      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚â”‚  Persistance Ã©tats dans table service_states â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW     â”‚
â”‚  Restauration automatique au dÃ©marrage via lifespan() â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FLUX DE DONNÃ‰ES PRINCIPAL                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  1. Ã‰COUTE MUSICALE                                                          â”‚
â”‚     Utilisateur Ã©coute via Roon ARC / PlexAmp / Quobuz                      â”‚
â”‚                    â†“                                                         â”‚
â”‚     Scrobble automatique vers Last.fm                                       â”‚
â”‚                    â†“                                                         â”‚
â”‚     TrackerService dÃ©tecte nouveau track (polling 120s)                     â”‚
â”‚                    â†“                                                         â”‚
â”‚     Enrichissement automatique:                                             â”‚
â”‚       - Spotify: images, URLs                                               â”‚
â”‚       - EurIA: description IA                                               â”‚
â”‚                    â†“                                                         â”‚
â”‚     Sauvegarde dans listening_history                                       â”‚
â”‚                                                                              â”‚
â”‚  2. Ã‰COUTE ROON DIRECTE â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW      â”‚
â”‚     Utilisateur Ã©coute via Roon (local)                                     â”‚
â”‚                    â†“                                                         â”‚
â”‚     RoonTrackerService dÃ©tecte lecture (polling 120s)                       â”‚
â”‚                    â†“                                                         â”‚
â”‚     Widget FloatingRoonController affiche en temps rÃ©el                     â”‚
â”‚                    â†“                                                         â”‚
â”‚     Utilisateur contrÃ´le depuis interface (Play/Pause/Next)                 â”‚
â”‚                                                                              â”‚
â”‚  3. COLLECTION DISCOGS                                                       â”‚
â”‚     Import manuel depuis Discogs                                            â”‚
â”‚                    â†“                                                         â”‚
â”‚     DiscogsService rÃ©cupÃ¨re collection                                      â”‚
â”‚                    â†“                                                         â”‚
â”‚     Enrichissement Spotify (images, URLs)                                   â”‚
â”‚                    â†“                                                         â”‚
â”‚     Sauvegarde dans albums (source='discogs')                               â”‚
â”‚                                                                              â”‚
â”‚  4. GÃ‰NÃ‰RATION PLAYLISTS                                                     â”‚
â”‚     Utilisateur demande playlist (algorithme choisi)                        â”‚
â”‚                    â†“                                                         â”‚
â”‚     SÃ©lection tracks selon critÃ¨res                                         â”‚
â”‚                    â†“                                                         â”‚
â”‚     Sauvegarde dans playlists + playlist_tracks                             â”‚
â”‚                    â†“                                                         â”‚
â”‚     Option: Lancer sur Roon via RoonService â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW    â”‚
â”‚                                                                              â”‚
â”‚  5. TÃ‚CHES AUTOMATIQUES                                                      â”‚
â”‚     SchedulerService exÃ©cute selon planning                                 â”‚
â”‚                    â†“                                                         â”‚
â”‚     Export fichiers â†’ "Scheduled Output/"                                   â”‚
â”‚                    â†“                                                         â”‚
â”‚     Cleanup automatique (garde 5 derniers)                                  â”‚
â”‚                                                                              â”‚
â”‚  6. GÃ‰NÃ‰RATION MAGAZINE â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NOUVEAU v4.4â”‚
â”‚     Utilisateur accÃ¨de Ã  la page /magazine                                  â”‚
â”‚                    â†“                                                         â”‚
â”‚     Frontend appelle GET /api/v1/magazines/generate                         â”‚
â”‚                    â†“                                                         â”‚
â”‚     MagazineGeneratorService gÃ©nÃ¨re contenu:                               â”‚
â”‚       1. SÃ©lection artiste/album alÃ©atoires                                â”‚
â”‚       2. RÃ©cupÃ©ration mÃ©tadonnÃ©es enrichies (Spotify, IA)                  â”‚
â”‚       3. GÃ©nÃ©ration haÃ¯kus/descriptions EurIA                              â”‚
â”‚       4. RÃ©cupÃ©ration timeline Ã©coutes rÃ©centes                            â”‚
â”‚       5. Construction 5 pages Ã©ditorialisÃ©es                               â”‚
â”‚       6. Layouts/couleurs variables alÃ©atoires                             â”‚
â”‚                    â†“                                                         â”‚
â”‚     Response: DonnÃ©es JSON + images URLs + HTML rendu                       â”‚
â”‚                    â†“                                                         â”‚
â”‚     Frontend affiche 5 pages scrollables                                    â”‚
â”‚                    â†“                                                         â”‚
â”‚     Auto-refresh: toutes les 15 minutes                                     â”‚
â”‚     Utilisateur peut cliquer "Nouvelle Ã©dition" â†’ rÃ©appel API              â”‚
â”‚                    â†“                                                         â”‚
â”‚     Archives magazine optionnelles dans table magazines (DB)                â”‚
â”‚                                                                              â”‚
â”‚                                                                              â”‚
â”‚  6. AUTO-RESTART â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW      â”‚
â”‚     Serveur dÃ©marre                                                          â”‚
â”‚                    â†“                                                         â”‚
â”‚     main.py â†’ lifespan() â†’ restore_active_services()                        â”‚
â”‚                    â†“                                                         â”‚
â”‚     Lecture table service_states                                            â”‚
â”‚                    â†“                                                         â”‚
â”‚     Restauration automatique services actifs:                               â”‚
â”‚       - TrackerService (if is_active=True)                                  â”‚
â”‚       - RoonTrackerService (if is_active=True + attente zones)              â”‚
â”‚       - SchedulerService (if is_active=True)                                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CONTRÃ”LE ROON (Nouveau v4.3.1)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  RoonService (pyroon)                                                        â”‚
â”‚  â”œâ”€ Connexion: server IP + token + port 9330                                â”‚
â”‚  â”œâ”€ Timeout: 15 secondes                                                    â”‚
â”‚  â”œâ”€ Callback: state_callback pour changements zones                         â”‚
â”‚  â”œâ”€ Attente zones: jusqu'Ã  3 secondes aprÃ¨s connexion                       â”‚
â”‚  â””â”€ Zones cache: self.zones (mise Ã  jour automatique)                       â”‚
â”‚                                                                              â”‚
â”‚  Endpoints Roon Control:                                                     â”‚
â”‚  â”œâ”€ GET  /api/v1/roon/status       : Ã‰tat connexion                         â”‚
â”‚  â”œâ”€ GET  /api/v1/roon/zones        : Liste zones disponibles                â”‚
â”‚  â”œâ”€ GET  /api/v1/roon/now-playing  : Morceau en cours                       â”‚
â”‚  â”œâ”€ POST /api/v1/roon/play         : DÃ©marrer lecture                       â”‚
â”‚  â”œâ”€ POST /api/v1/roon/pause        : Pause                                  â”‚
â”‚  â”œâ”€ POST /api/v1/roon/next         : Track suivant                          â”‚
â”‚  â”œâ”€ POST /api/v1/roon/previous     : Track prÃ©cÃ©dent                        â”‚
â”‚  â””â”€ POST /api/v1/roon/stop         : ArrÃªter lecture                        â”‚
â”‚                                                                              â”‚
â”‚  Frontend Components:                                                        â”‚
â”‚  â”œâ”€ FloatingRoonController          : Widget flottant glassmorphism         â”‚
â”‚  â”‚  â”œâ”€ Affichage: Title, Artist, Album                                      â”‚
â”‚  â”‚  â”œâ”€ Polling: Toutes les 3 secondes                                       â”‚
â”‚  â”‚  â”œâ”€ Controls: â®ï¸ â¸ï¸ â­ï¸ â¹ï¸                                                    â”‚
â”‚  â”‚  â””â”€ Minimizable: RÃ©duire en coin                                         â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â””â”€ Playlists.tsx                                                            â”‚
â”‚     â”œâ”€ Inline controls par playlist                                         â”‚
â”‚     â”œâ”€ Active playlist tracking (localStorage)                              â”‚
â”‚     â”œâ”€ Display now-playing uniquement sur playlist active                   â”‚
â”‚     â””â”€ Timeout 120s pour gÃ©nÃ©ration IA                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MAGAZINE Ã‰DITORIAL (Nouveau v4.4)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  MagazineGeneratorService (Backend):                                        â”‚
â”‚  â”œâ”€ Orchestration complÃ¨te gÃ©nÃ©ration magazine                             â”‚
â”‚  â”œâ”€ SÃ©lection contenus alÃ©atoires:                                         â”‚
â”‚  â”‚  â”œâ”€ Artiste alÃ©atoire pour Page 1                                       â”‚
â”‚  â”‚  â”œâ”€ Album spotlight (top Ã©coutÃ© rÃ©cemment) pour Page 2                 â”‚
â”‚  â”‚  â”œâ”€ 3 albums alÃ©atoires pour haÃ¯kus Page 3                             â”‚
â”‚  â”‚  â”œâ”€ Timeline rÃ©elle derniÃ¨res 24h pour Page 4                          â”‚
â”‚  â”‚  â””â”€ ThÃ¨me alÃ©atoire pour playlist thÃ¨me Page 5                         â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”œâ”€ IntÃ©gration EurIA:                                                     â”‚
â”‚  â”‚  â”œâ”€ generate_haiku() : haÃ¯kus 5-7-5 syllabes                           â”‚
â”‚  â”‚  â”œâ”€ generate_album_description() : 2000+ caractÃ¨res poÃ©tiques          â”‚
â”‚  â”‚  â”œâ”€ generate_playlist_theme() : thÃ¨mes crÃ©atifs                        â”‚
â”‚  â”‚  â””â”€ generate_artistic_title() : titres engageants                      â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”œâ”€ Design variabilitÃ©:                                                    â”‚
â”‚  â”‚  â”œâ”€ 3 palettes couleurs alÃ©atoires (pastel/vibrant/dark)              â”‚
â”‚  â”‚  â”œâ”€ 2 layouts variables (image left/right, texte adapt)               â”‚
â”‚  â”‚  â”œâ”€ 3 typographies thÃ©matiques                                         â”‚
â”‚  â”‚  â””â”€ Animation transitions fluides entre pages                          â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”œâ”€ Endpoints:                                                             â”‚
â”‚  â”‚  â”œâ”€ GET  /api/v1/magazines/generate      : GÃ©nÃ©rer magazine           â”‚
â”‚  â”‚  â””â”€ POST /api/v1/magazines/regenerate    : Alias trigger              â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â””â”€ Response JSON: { pages: [...], palette, layout, timestamp }           â”‚
â”‚                                                                              â”‚
â”‚  Frontend Component (Magazine.tsx):                                         â”‚
â”‚  â”œâ”€ Route: /magazine                                                       â”‚
â”‚  â”œâ”€ 5 pages scrollables:                                                   â”‚
â”‚  â”‚  â”œâ”€ Page 1: Artist card + albums gallery + haÃ¯ku                       â”‚
â”‚  â”‚  â”œâ”€ Page 2: Album hero + description + metadata                        â”‚
â”‚  â”‚  â”œâ”€ Page 3: 3 haÃ¯kus cards + artists images                            â”‚
â”‚  â”‚  â”œâ”€ Page 4: Timeline events + listening stats + charts                 â”‚
â”‚  â”‚  â””â”€ Page 5: Playlist grid + theme title + desc.                        â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”œâ”€ ContrÃ´les:                                                             â”‚
â”‚  â”‚  â”œâ”€ Navigation: scroll souris, flÃ¨ches clavier, swipe mobile           â”‚
â”‚  â”‚  â”œâ”€ Bouton: "Nouvelle Ã‰dition" â†’ regÃ©nÃ¨re via API                      â”‚
â”‚  â”‚  â”œâ”€ Pagination: 5 dots + numÃ©ro page actuelle                          â”‚
â”‚  â”‚  â”œâ”€ Minuteur: compte Ã  rebours 15 min avant auto-refresh               â”‚
â”‚  â”‚  â””â”€ VisibilitÃ©: icÃ´ne horloge, % progression                           â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”œâ”€ Styles (Glassmorphism v4.4):                                           â”‚
â”‚  â”‚  â”œâ”€ ArriÃ¨re-plan dÃ©gradÃ© semi-transparent                              â”‚
â”‚  â”‚  â”œâ”€ Blur effet (backdrop-filter: blur 10px)                            â”‚
â”‚  â”‚  â”œâ”€ Bordures frosted glass translucent                                 â”‚
â”‚  â”‚  â”œâ”€ Animations smooth page transitions                                 â”‚
â”‚  â”‚  â””â”€ Couleurs dynamiques selon palette gÃ©nÃ©rÃ©e                          â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â””â”€ Auto-refresh:                                                          â”‚
â”‚     â”œâ”€ Timer 15 minutes (localStorage persistence)                        â”‚
â”‚     â”œâ”€ Auto call GET /magazines/generate                                  â”‚
â”‚     â”œâ”€ Transition fluide nouvelle Ã©dition                                 â”‚
â”‚     â””â”€ Minuteur reset aprÃ¨s gÃ©nÃ©ration                                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CONFIGURATION ET DÃ‰PLOIEMENT                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Fichiers Configuration:                                                     â”‚
â”‚  â”œâ”€ config/app.json          : Config application (roon_server, intervals)  â”‚
â”‚  â”œâ”€ config/secrets.json      : API keys (GITIGNORE)                         â”‚
â”‚  â”œâ”€ backend/requirements.txt : DÃ©pendances Python                           â”‚
â”‚  â””â”€ frontend/package.json    : DÃ©pendances Node.js                          â”‚
â”‚                                                                              â”‚
â”‚  Scripts:                                                                    â”‚
â”‚  â”œâ”€ scripts/setup.sh         : Installation complÃ¨te                        â”‚
â”‚  â”œâ”€ scripts/start-dev.sh     : DÃ©marrage mode dev (backend + frontend)      â”‚
â”‚  â”œâ”€ scripts/enrich_all_fast.py : Enrichissement batch                       â”‚
â”‚  â””â”€ scripts/check_sync.py    : VÃ©rification synchronisation                 â”‚
â”‚                                                                              â”‚
â”‚  Docker:                                                                     â”‚
â”‚  â”œâ”€ backend/Dockerfile       : Image Python FastAPI                         â”‚
â”‚  â”œâ”€ frontend/Dockerfile      : Image Node.js React                          â”‚
â”‚  â””â”€ docker-compose.yml       : Orchestration complÃ¨te                       â”‚
â”‚                                                                              â”‚
â”‚  Base de DonnÃ©es:                                                            â”‚
â”‚  â”œâ”€ backend/init_db.py                : Initialisation                      â”‚
â”‚  â”œâ”€ backend/create_service_states_table.py : Migration auto-restart â—„â”€ NEW  â”‚
â”‚  â”œâ”€ backend/test_auto_restart.py     : Tests auto-restart â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW   â”‚
â”‚  â””â”€ backend/alembic/versions/         : Migrations historiques              â”‚
â”‚     â”œâ”€ 001_add_source_column.py                                             â”‚
â”‚     â”œâ”€ 002_fix_invalid_supports.py                                          â”‚
â”‚     â”œâ”€ 003_add_service_states.py â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW     â”‚
â”‚     â””â”€ 004_add_magazines_table.py â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ v4.4      â”‚
â”‚                                                                              â”‚
â”‚  Fichiers Backend (v4.4):                                                    â”‚
â”‚  â”œâ”€ backend/app/services/magazine_generator_service.py : Orchestration      â”‚
â”‚  â”œâ”€ backend/app/api/v1/magazines.py : Endpoints /magazines                  â”‚
â”‚  â”œâ”€ backend/app/models/magazine.py : Model Magazine SQLAlchemy             â”‚
â”‚  â””â”€ backend/app/schemas/magazine.py : Schemas Pydantic                      â”‚
â”‚                                                                              â”‚
â”‚  Fichiers Frontend (v4.4):                                                   â”‚
â”‚  â”œâ”€ frontend/src/pages/Magazine.tsx : Page principale                       â”‚
â”‚  â”œâ”€ frontend/src/components/MagazinePage.tsx : Composant 5 pages           â”‚
â”‚  â”œâ”€ frontend/src/components/MagazineCard.tsx : Card rÃ©utilisable           â”‚
â”‚  â””â”€ frontend/src/api/magazines.ts : Client API magazines                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SÃ‰CURITÃ‰ ET PERFORMANCE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  SÃ©curitÃ©:                                                                   â”‚
â”‚  â”œâ”€ CORS configurÃ© (allow_origins, credentials)                             â”‚
â”‚  â”œâ”€ Secrets dans .gitignore                                                 â”‚
â”‚  â”œâ”€ Validation Pydantic sur tous les endpoints                              â”‚
â”‚  â”œâ”€ Token Roon sauvegardÃ© de maniÃ¨re sÃ©curisÃ©e                              â”‚
â”‚  â””â”€ Exception handlers centralisÃ©s                                          â”‚
â”‚                                                                              â”‚
â”‚  Performance:                                                                â”‚
â”‚  â”œâ”€ Indexes DB sur colonnes frÃ©quemment requÃªtÃ©es                           â”‚
â”‚  â”œâ”€ Pagination sur endpoints collection/history                             â”‚
â”‚  â”œâ”€ Cache zones Roon (self.zones)                                           â”‚
â”‚  â”œâ”€ Polling intelligent (120s par dÃ©faut)                                   â”‚
â”‚  â”œâ”€ Connexion Roon avec timeout (15s)                                       â”‚
â”‚  â””â”€ APScheduler AsyncIO pour non-blocking                                   â”‚
â”‚                                                                              â”‚
â”‚  Monitoring:                                                                 â”‚
â”‚  â”œâ”€ Health check endpoint: /health                                          â”‚
â”‚  â”œâ”€ Readiness probe: /ready                                                 â”‚
â”‚  â”œâ”€ Logs structurÃ©s avec niveaux                                            â”‚
â”‚  â”œâ”€ Request ID tracking                                                     â”‚
â”‚  â”œâ”€ Process time middleware                                                 â”‚
â”‚  â””â”€ Status all services: /api/v1/services/status/all                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             STACK TECHNOLOGIQUE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Backend:                                                                    â”‚
â”‚  â”œâ”€ Python 3.10-3.14                                                         â”‚
â”‚  â”œâ”€ FastAPI (web framework)                                                 â”‚
â”‚  â”œâ”€ SQLAlchemy (ORM)                                                        â”‚
â”‚  â”œâ”€ Pydantic (validation)                                                   â”‚
â”‚  â”œâ”€ APScheduler (background tasks)                                          â”‚
â”‚  â”œâ”€ pyroon (Roon API) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW       â”‚
â”‚  â”œâ”€ requests (HTTP client)                                                  â”‚
â”‚  â””â”€ Alembic (migrations)                                                    â”‚
â”‚                                                                              â”‚
â”‚  Frontend:                                                                   â”‚
â”‚  â”œâ”€ React 18                                                                â”‚
â”‚  â”œâ”€ TypeScript                                                              â”‚
â”‚  â”œâ”€ Material-UI (MUI)                                                       â”‚
â”‚  â”œâ”€ Vite (build tool)                                                       â”‚
â”‚  â”œâ”€ Axios (HTTP client)                                                     â”‚
â”‚  â”œâ”€ React Query (data fetching)                                             â”‚
â”‚  â””â”€ React Router (navigation)                                               â”‚
â”‚                                                                              â”‚
â”‚  Base de DonnÃ©es:                                                            â”‚
â”‚  â””â”€ SQLite (fichier: backend/data/musique.db)                               â”‚
â”‚                                                                              â”‚
â”‚  APIs Externes:                                                              â”‚
â”‚  â”œâ”€ Last.fm API                                                             â”‚
â”‚  â”œâ”€ Spotify Web API                                                         â”‚
â”‚  â”œâ”€ Discogs API                                                             â”‚
â”‚  â”œâ”€ Roon API (pyroon) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NEW       â”‚
â”‚  â””â”€ EurIA (Infomaniak AI)                                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
